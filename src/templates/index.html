{% extends "./layout/base.html" %}
{% block content %}

<h1>Top page</h1>
<a role="button" class="btn btn-primary" href="/get_pip">Get pip freeze</a>
<button type="button" class="btn btn-success" id="get_pip_ajax_button">Get pip freeze with ajax</button>

<ul id="pip_list"></ul>
<script>
    document.querySelector('#get_pip_ajax_button').addEventListener('click', () => {
        let req = new XMLHttpRequest();
        req.open("POST", "/get_pip_ajax", true);
        req.onreadystatechange = function () {
            if (req.readyState != 4 || req.status != 200) {
                return;
            }
            let pipList = JSON.parse(req.responseText)
            for (let i=0; i< pipList.length; i++) {
                let liObj = document.createElement('li');
                console.log(pipList[i])
                liObj.textContent = pipList[i]
                document.getElementById('pip_list').appendChild(liObj);
            }
        }
        req.send();
    });
</script>
{% endblock %}